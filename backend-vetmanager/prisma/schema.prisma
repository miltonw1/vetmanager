// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int        @id @default(autoincrement())
  email     String     @unique
  name      String?
  passwords Password[]
}

model Password {
  id         Int      @id @default(autoincrement())
  user       User     @relation(fields: [user_id], references: [id])
  user_id    Int
  body       String
  created_at DateTime @default(now())
  version    String?
}

model Client {
  id      Int     @id @default(autoincrement())
  name    String
  phone   String
  email   String?
  address String?
  city    String?
  debt    String?
  pets    Pet[]
}

model Pet {
  id          Int          @id @default(autoincrement())
  name        String
  allergies   String?
  genre       Genre?
  weight      Decimal?
  birthday    DateTime?
  blood_type  String?
  life_status LifeStatus   @default(ALIVE)
  species     Species      @relation(fields: [species_id], references: [id])
  species_id  Int
  race        Race?        @relation(fields: [race_id], references: [id])
  race_id     Int?
  owner       Client       @relation(fields: [client_id], references: [id])
  client_id   Int
  histories   PetHistory[]
}

model PetHistory {
  id          Int               @id @default(autoincrement())
  pet         Pet               @relation(fields: [pet_id], references: [id])
  pet_id      Int
  diagnostic  String
  observation String?
  weight      Decimal?
  images      PetHistoryImage[]
  created_at  DateTime          @default(now())
}

model PetHistoryImage {
  id             Int        @id @default(autoincrement())
  pet_history    PetHistory @relation(fields: [pet_history_id], references: [id])
  pet_history_id Int

  image_src String?
  image_url String?
}

model Race {
  id         Int     @id @default(autoincrement())
  name       String
  species    Species @relation(fields: [species_id], references: [id])
  species_id Int
  pets       Pet[]
}

model Species {
  id    Int    @id @default(autoincrement())
  name  String
  races Race[]
  pets  Pet[]
}

enum Genre {
  MALE
  FEMALE
}

enum LifeStatus {
  DEAD
  ALIVE
}
